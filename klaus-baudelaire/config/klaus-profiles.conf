# klaus-profiles.conf
# Delegation Profile System - User-selectable routing profiles
#
# Usage:
#   1. Auto-detection: Create .klaus-profile file in repository root with profile name
#   2. Manual override: Set KLAUS_PROFILE environment variable
#
# Format: Git-style configuration with [profile "name"] sections
# Thresholds define complexity score ranges for tier routing:
#   DIRECT:  0 - (LIGHT_THRESHOLD - 1)
#   LIGHT:   LIGHT_THRESHOLD - (MEDIUM_THRESHOLD - 1)
#   MEDIUM:  MEDIUM_THRESHOLD - (FULL_THRESHOLD - 1)
#   FULL:    FULL_THRESHOLD+

# ================================================================
# CONSERVATIVE PROFILE
# ================================================================
# Higher thresholds = fewer Plan agent invocations = lower cost
# Best for: Budget-conscious projects, simple codebases, solo developers
# Trade-off: May miss some opportunities for comprehensive analysis

[profile "conservative"]
    description = "Higher thresholds for cost-conscious workflows"
    use_case = "Budget-conscious projects, simple codebases, solo developers"

    # Tier thresholds (monotonic: LIGHT < MEDIUM < FULL)
    light_threshold = 3
    medium_threshold = 7
    full_threshold = 12

    # Keyword weight adjustments (relative to baseline)
    # Negative values reduce trigger frequency
    weight_refactor = 2           # "refactor" keyword (baseline: 3)
    weight_implement = 1           # "implement" keyword (baseline: 2)
    weight_system = 0              # "system" keyword (baseline: 1)
    weight_across_multiple = 0     # "across multiple" keyword (baseline: 1)

    # Feature flags
    enable_plan_orchestration = true
    enable_routing_explanation = true

# ================================================================
# BALANCED PROFILE (DEFAULT)
# ================================================================
# Standard thresholds = balanced cost/intelligence trade-off
# Best for: Most projects, teams of 2-5 developers, mixed complexity
# Trade-off: Good balance between comprehensive analysis and cost

[profile "balanced"]
    description = "Standard thresholds for balanced workflows"
    use_case = "Most projects, teams of 2-5 developers, mixed complexity"

    # Tier thresholds (baseline thresholds)
    light_threshold = 3
    medium_threshold = 5
    full_threshold = 7

    # Keyword weight adjustments (baseline values)
    weight_refactor = 3
    weight_implement = 2
    weight_system = 2
    weight_across_multiple = 1

    # Feature flags
    enable_plan_orchestration = true
    enable_routing_explanation = true

# ================================================================
# AGGRESSIVE PROFILE
# ================================================================
# Lower thresholds = more Plan agent invocations = higher intelligence
# Best for: Complex projects, large teams (6+), critical systems
# Trade-off: Higher cost but more comprehensive analysis

[profile "aggressive"]
    description = "Lower thresholds for maximum intelligence"
    use_case = "Complex projects, large teams (6+), critical systems"

    # Tier thresholds (lower = more MEDIUM/FULL routing)
    light_threshold = 3
    medium_threshold = 3
    full_threshold = 8

    # Keyword weight adjustments (higher = more sensitive)
    weight_refactor = 4           # Boost refactoring detection
    weight_implement = 3          # Boost implementation detection
    weight_system = 2             # Boost system-level detection
    weight_across_multiple = 2    # Boost multi-component detection

    # Feature flags
    enable_plan_orchestration = true
    enable_routing_explanation = true

# ================================================================
# CUSTOM PROFILE TEMPLATE
# ================================================================
# Copy this template to create custom profiles
# Uncomment and modify values as needed

# [profile "custom"]
#     description = "Custom profile description"
#     use_case = "Your specific use case"
#
#     # Tier thresholds (must be monotonic: LIGHT < MEDIUM < FULL)
#     light_threshold = 3
#     medium_threshold = 5
#     full_threshold = 10
#
#     # Keyword weight adjustments
#     weight_refactor = 3
#     weight_implement = 2
#     weight_system = 1
#     weight_across_multiple = 1
#
#     # Feature flags
#     enable_plan_orchestration = true
#     enable_routing_explanation = true

# ================================================================
# VALIDATION RULES
# ================================================================
# 1. Thresholds must be positive integers
# 2. Thresholds must be monotonic: light_threshold <= medium_threshold <= full_threshold
# 3. Keyword weights must be non-negative integers
# 4. Profile names must be alphanumeric with optional underscores/hyphens
# 5. All profiles must have complete threshold definitions

# ================================================================
# PROFILE SWITCHING
# ================================================================
# Method 1: .klaus-profile file (auto-detection)
#   Create .klaus-profile in repository root:
#   echo "aggressive" > .klaus-profile
#
# Method 2: Environment variable (manual override)
#   export KLAUS_PROFILE=conservative
#
# Method 3: Per-directory override (git-style includeIf)
#   [FUTURE]: Configure in ~/.config/klaus/profiles
#   [includeIf "gitdir:~/work/critical-project/"]
#       profile = aggressive
#   [includeIf "gitdir:~/personal/"]
#       profile = conservative

# ================================================================
# THRESHOLD CALIBRATION NOTES
# ================================================================
# Score ranges based on keyword analysis:
#   0-2:  Simple queries ("check status", "quick fix")
#   3-4:  Single-file tasks ("investigate auth", "add logging")
#   5-9:  Multi-file refactoring ("refactor error handling across files")
#   10+:  System-wide changes ("design comprehensive architecture")
#
# Conservative: Saves ~40% Plan agent invocations vs balanced
# Aggressive:   Adds ~60% Plan agent invocations vs balanced
#
# Cost impact (approximate, per 100 prompts):
#   Conservative: 20-30 MEDIUM/FULL tier invocations
#   Balanced:     35-50 MEDIUM/FULL tier invocations
#   Aggressive:   55-80 MEDIUM/FULL tier invocations
